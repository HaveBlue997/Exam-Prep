<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Adaptive Practice Quiz - Pokemon</title>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --navy: #1a2744;
            --burgundy: #7c2d3e;
            --cream: #f8f5f0;
            --gold: #c9a959;
            --white: #ffffff;
            --light-gray: #e8e4df;
            --dark-gray: #4a4a4a;
            --success-green: #2d5a3d;
            --error-red: #8b3a3a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Sans 3', sans-serif;
            background: var(--cream);
            min-height: 100vh;
            color: var(--navy);
            line-height: 1.6;
        }

        /* Navigation Bar */
        .nav-bar {
            background: var(--navy);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-bar a {
            color: var(--cream);
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.3s;
        }

        .nav-bar a:hover {
            color: var(--gold);
        }

        .nav-title {
            color: var(--gold);
            font-family: 'Libre Baskerville', serif;
            font-size: 1.1rem;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--navy) 0%, #2a3f5f 100%);
            padding: 3rem 2rem;
            text-align: center;
            color: var(--cream);
        }

        .header h1 {
            font-family: 'Libre Baskerville', serif;
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
            color: var(--white);
        }

        .header .subtitle {
            font-size: 1.1rem;
            color: var(--gold);
            margin-bottom: 0.5rem;
        }

        .header .focus-areas {
            font-size: 0.95rem;
            color: var(--light-gray);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        /* Cards */
        .card {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--light-gray);
        }

        /* Student Info Section */
        .name-date {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-weight: 600;
            color: var(--navy);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .input-group input {
            padding: 0.75rem;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            font-size: 1rem;
            font-family: 'Source Sans 3', sans-serif;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--burgundy);
        }

        /* Instructions */
        .instructions {
            background: var(--cream);
            padding: 1.5rem;
            border-left: 4px solid var(--gold);
            margin-bottom: 1.5rem;
            border-radius: 0 6px 6px 0;
        }

        .instructions h3 {
            color: var(--burgundy);
            margin-bottom: 0.75rem;
            font-family: 'Libre Baskerville', serif;
            font-size: 1.1rem;
        }

        .instructions ul {
            margin-left: 1.5rem;
            color: var(--dark-gray);
        }

        .instructions li {
            margin-bottom: 0.5rem;
        }

        .encouragement {
            background: linear-gradient(135deg, #f0f7f1 0%, #e8f4e9 100%);
            border-left-color: var(--success-green);
            margin-top: 1rem;
        }

        .encouragement p {
            color: var(--success-green);
            font-weight: 600;
        }

        /* Progress Indicator */
        .progress-indicator {
            background: var(--cream);
            padding: 1rem 1.5rem;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--light-gray);
        }

        .progress-indicator strong {
            color: var(--burgundy);
            font-family: 'Libre Baskerville', serif;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: var(--light-gray);
            border-radius: 4px;
            margin: 0 1rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--burgundy) 0%, var(--gold) 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        /* Section Titles */
        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light-gray);
        }

        .section-icon {
            width: 48px;
            height: 48px;
            background: var(--burgundy);
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Libre Baskerville', serif;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .section-title {
            font-family: 'Libre Baskerville', serif;
            color: var(--navy);
            font-size: 1.4rem;
        }

        .section-subtitle {
            color: var(--dark-gray);
            font-size: 0.95rem;
            margin-top: 0.25rem;
        }

        /* Questions */
        .question {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--cream);
            border-radius: 8px;
            border: 1px solid var(--light-gray);
            transition: border-color 0.3s;
        }

        .question:hover {
            border-color: var(--gold);
        }

        .question-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .question-number {
            width: 32px;
            height: 32px;
            background: var(--burgundy);
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .question-text {
            font-weight: 600;
            color: var(--navy);
            font-size: 1.05rem;
            line-height: 1.5;
        }

        .topic-tag {
            display: inline-block;
            background: var(--navy);
            color: var(--cream);
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            margin-left: 0.5rem;
            opacity: 0.7;
        }

        /* Options */
        .options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-left: 2.5rem;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: var(--white);
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .option:hover {
            border-color: var(--burgundy);
            background: rgba(124, 45, 62, 0.05);
        }

        .option input[type="radio"] {
            margin-right: 0.75rem;
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--burgundy);
        }

        .option label {
            cursor: pointer;
            flex: 1;
            color: var(--dark-gray);
            font-size: 0.95rem;
        }

        .option input[type="radio"]:checked + label {
            color: var(--burgundy);
            font-weight: 600;
        }

        /* Textarea for short answer */
        textarea {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            font-family: 'Source Sans 3', sans-serif;
            font-size: 1rem;
            resize: vertical;
            margin-top: 1rem;
            margin-left: 2.5rem;
            width: calc(100% - 2.5rem);
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: var(--burgundy);
        }

        .answer-hint {
            background: rgba(201, 169, 89, 0.15);
            padding: 1rem;
            border-left: 4px solid var(--gold);
            margin: 1rem 0 0 2.5rem;
            border-radius: 0 6px 6px 0;
            font-size: 0.9rem;
        }

        .answer-hint strong {
            color: var(--burgundy);
        }

        /* Submit Section */
        .submit-section {
            text-align: center;
            padding: 2rem;
            background: var(--cream);
            border-radius: 8px;
        }

        .submit-section h3 {
            margin-bottom: 1rem;
            color: var(--navy);
            font-family: 'Libre Baskerville', serif;
        }

        .submit-section p {
            margin-bottom: 1.5rem;
            color: var(--dark-gray);
        }

        .btn {
            padding: 1rem 2.5rem;
            font-size: 1rem;
            font-weight: 700;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Source Sans 3', sans-serif;
        }

        .btn-primary {
            background: var(--burgundy);
            color: var(--white);
            box-shadow: 0 4px 12px rgba(124, 45, 62, 0.3);
        }

        .btn-primary:hover {
            background: #5a1f2d;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(124, 45, 62, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        /* Grading Overlay */
        .grading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--navy) 0%, #2a3f5f 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .grading-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .grading-overlay .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(201, 169, 89, 0.3);
            border-top-color: var(--gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 2rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .grading-overlay h2 {
            color: var(--white);
            font-family: 'Libre Baskerville', serif;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .grading-overlay p {
            color: var(--cream);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .grading-overlay .status-message {
            color: var(--gold);
            font-weight: 700;
            margin-top: 1rem;
        }

        .grading-overlay .error-message {
            color: var(--error-red);
            background: var(--white);
            padding: 1rem 2rem;
            border-radius: 6px;
            margin-top: 1rem;
            max-width: 400px;
            text-align: center;
        }

        .grading-overlay .btn {
            margin-top: 1.5rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.6rem;
            }

            .name-date {
                grid-template-columns: 1fr;
            }

            .nav-bar {
                padding: 1rem;
            }

            .nav-title {
                font-size: 0.9rem;
            }

            .container {
                padding: 1rem 0.75rem;
            }

            .card {
                padding: 1.5rem;
            }

            .question {
                padding: 1rem;
            }

            .options {
                margin-left: 0;
            }

            textarea {
                margin-left: 0;
                width: 100%;
            }

            .answer-hint {
                margin-left: 0;
            }

            .section-icon {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }

            .section-title {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Grading Overlay -->
    <div id="grading-overlay" class="grading-overlay">
        <div class="spinner"></div>
        <h2>Grading Quiz...</h2>
        <p>Professor Oak is analyzing your answers</p>
        <p class="status-message" id="grading-status">Initializing...</p>
        <div id="grading-error" class="error-message" style="display: none;"></div>
        <button id="grading-retry-btn" class="btn btn-primary" style="display: none;" onclick="retryGrading()">Try Again</button>
    </div>

    <!-- Navigation -->
    <nav class="nav-bar">
        <a href="/">← Back to Home</a>
        <span class="nav-title">Pokemon - Adaptive Practice</span>
    </nav>

    <!-- Header -->
    <div class="header">
        <h1>Adaptive Practice Quiz</h1>
        <p class="subtitle">Personalized for Student01</p>
        <p class="focus-areas">Focus Areas: Evolution Lines • Dual-Type Mechanics • Lucario • Gyarados • Eevee</p>
    </div>

    <div class="container">
        <!-- Student Info Card -->
        <div class="card">
            <div class="name-date">
                <div class="input-group">
                    <label for="student-name">Student Name *</label>
                    <input type="text" id="student-name" value="Student01" required>
                </div>
                <div class="input-group">
                    <label for="quiz-date">Date</label>
                    <input type="date" id="quiz-date">
                </div>
            </div>

            <div class="instructions">
                <h3>Instructions</h3>
                <ul>
                    <li>Answer all 19 multiple choice questions (1 point each)</li>
                    <li>Complete the short answer question (2 points)</li>
                    <li>Take your time - this quiz is designed to help you improve</li>
                    <li>Click "Submit Quiz" when finished for instant feedback</li>
                </ul>
            </div>

            <div class="instructions encouragement">
                <p>Hey Student01! This quiz focuses on areas where extra practice will help you shine on the exam. You've already shown solid understanding of type matchup basics, battle counters, and several Pokemon like Blastoise and Snorlax. Now let's build your confidence with evolution concepts, dual-type mechanics, and some of the trickier Pokemon analyses!</p>
            </div>

            <div class="progress-indicator">
                <strong>Progress:</strong>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <span id="progress">0/20 answered</span>
            </div>
        </div>

        <!-- Section I: Multiple Choice -->
        <div class="card">
            <div class="section-header">
                <div class="section-icon">I</div>
                <div>
                    <h2 class="section-title">Multiple Choice</h2>
                    <p class="section-subtitle">Select the best answer for each question (19 questions, 1 point each)</p>
                </div>
            </div>

            <!-- Q1: Evolution Lines (WEAK - 0-33% across sessions) -->
            <div class="question" data-topic="evolution-lines">
                <div class="question-header">
                    <span class="question-number">1</span>
                    <span class="question-text">What is the correct order of Squirtle's evolution line?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q1" id="q1a" value="a">
                        <label for="q1a">Wartortle → Squirtle → Blastoise</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q1" id="q1b" value="b">
                        <label for="q1b">Squirtle → Wartortle → Blastoise</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q1" id="q1c" value="c">
                        <label for="q1c">Blastoise → Wartortle → Squirtle</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q1" id="q1d" value="d">
                        <label for="q1d">Squirtle → Blastoise → Wartortle</label>
                    </div>
                </div>
            </div>

            <!-- Q2: Lucario Analysis (VERY WEAK - 0% all sessions) -->
            <div class="question" data-topic="lucario-analysis">
                <div class="question-header">
                    <span class="question-number">2</span>
                    <span class="question-text">Lucario (Fighting/Steel) is weak to which of the following types?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q2" id="q2a" value="a">
                        <label for="q2a">Fairy, Psychic, and Ice</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q2" id="q2b" value="b">
                        <label for="q2b">Fire, Fighting, and Ground</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q2" id="q2c" value="c">
                        <label for="q2c">Water, Electric, and Grass</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q2" id="q2d" value="d">
                        <label for="q2d">Rock, Bug, and Normal</label>
                    </div>
                </div>
            </div>

            <!-- Q3: Dual-Type Mechanics (WEAK - 33-50% across sessions) -->
            <div class="question" data-topic="dual-type-mechanics">
                <div class="question-header">
                    <span class="question-number">3</span>
                    <span class="question-text">Venusaur is Grass/Poison type. If a Psychic-type attack hits Venusaur, which typing makes it take super-effective damage?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q3" id="q3a" value="a">
                        <label for="q3a">The Grass type (Psychic beats Grass)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q3" id="q3b" value="b">
                        <label for="q3b">The Poison type (Psychic beats Poison)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q3" id="q3c" value="c">
                        <label for="q3c">Both types (4x weakness)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q3" id="q3d" value="d">
                        <label for="q3d">Neither type (Psychic is resisted)</label>
                    </div>
                </div>
            </div>

            <!-- Q4: Gyarados Analysis (WEAK - 0-50% inconsistent) -->
            <div class="question" data-topic="gyarados-analysis">
                <div class="question-header">
                    <span class="question-number">4</span>
                    <span class="question-text">Why does Gyarados (Water/Flying) NOT have a Ground weakness despite being part Water-type?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q4" id="q4a" value="a">
                        <label for="q4a">Water resists Ground completely</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q4" id="q4b" value="b">
                        <label for="q4b">Flying is immune to Ground, canceling Water's weakness</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q4" id="q4c" value="c">
                        <label for="q4c">Ground only hits for 2x on dual-types</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q4" id="q4d" value="d">
                        <label for="q4d">Gyarados has a special ability that blocks Ground</label>
                    </div>
                </div>
            </div>

            <!-- Q5: Eevee-Eeveelutions (WEAK - 0-50% declining) -->
            <div class="question" data-topic="eevee-eeveelutions">
                <div class="question-header">
                    <span class="question-number">5</span>
                    <span class="question-text">Which of the following is an Eeveelution (an evolution of Eevee)?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q5" id="q5a" value="a">
                        <label for="q5a">Pikachu</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q5" id="q5b" value="b">
                        <label for="q5b">Sylveon</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q5" id="q5c" value="c">
                        <label for="q5c">Lucario</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q5" id="q5d" value="d">
                        <label for="q5d">Gardevoir</label>
                    </div>
                </div>
            </div>

            <!-- Q6: Evolution Lines (WEAK) -->
            <div class="question" data-topic="evolution-lines">
                <div class="question-header">
                    <span class="question-number">6</span>
                    <span class="question-text">What are the stages in a typical three-stage evolution line called?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q6" id="q6a" value="a">
                        <label for="q6a">Baby, Teen, Adult</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q6" id="q6b" value="b">
                        <label for="q6b">Base, Stage 1, Stage 2</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q6" id="q6c" value="c">
                        <label for="q6c">Starter, Evolved, Final</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q6" id="q6d" value="d">
                        <label for="q6d">Form 1, Form 2, Form 3</label>
                    </div>
                </div>
            </div>

            <!-- Q7: Dual-Type Mechanics (WEAK) -->
            <div class="question" data-topic="dual-type-mechanics">
                <div class="question-header">
                    <span class="question-number">7</span>
                    <span class="question-text">What happens when a dual-type Pokemon is hit by an attack that one type resists but the other type is weak to?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q7" id="q7a" value="a">
                        <label for="q7a">The attack always does 4x damage</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q7" id="q7b" value="b">
                        <label for="q7b">The resistance and weakness cancel out, resulting in normal (1x) damage</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q7" id="q7c" value="c">
                        <label for="q7c">The attack always misses</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q7" id="q7d" value="d">
                        <label for="q7d">The weakness always takes priority</label>
                    </div>
                </div>
            </div>

            <!-- Q8: Pikachu Analysis (WEAK - 0-100% inconsistent) -->
            <div class="question" data-topic="pikachu-analysis">
                <div class="question-header">
                    <span class="question-number">8</span>
                    <span class="question-text">Pikachu is an Electric-type. Which Pokemon from the Focus 10 list would Pikachu be super-effective against?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q8" id="q8a" value="a">
                        <label for="q8a">Venusaur (Grass/Poison)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q8" id="q8b" value="b">
                        <label for="q8b">Lucario (Fighting/Steel)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q8" id="q8c" value="c">
                        <label for="q8c">Gyarados (Water/Flying)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q8" id="q8d" value="d">
                        <label for="q8d">Snorlax (Normal)</label>
                    </div>
                </div>
            </div>

            <!-- Q9: Charizard Analysis (WEAK - 0-100% inconsistent) -->
            <div class="question" data-topic="charizard-analysis">
                <div class="question-header">
                    <span class="question-number">9</span>
                    <span class="question-text">Besides Rock (4x), which other types are super-effective against Charizard (Fire/Flying)?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q9" id="q9a" value="a">
                        <label for="q9a">Water and Electric</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q9" id="q9b" value="b">
                        <label for="q9b">Ground and Fighting</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q9" id="q9c" value="c">
                        <label for="q9c">Grass and Ice</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q9" id="q9d" value="d">
                        <label for="q9d">Psychic and Ghost</label>
                    </div>
                </div>
            </div>

            <!-- Q10: Regional Variants (WEAK - declined to 0%) -->
            <div class="question" data-topic="regional-variants">
                <div class="question-header">
                    <span class="question-number">10</span>
                    <span class="question-text">What is TRUE about regional variants?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q10" id="q10a" value="a">
                        <label for="q10a">They are completely different Pokemon species</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q10" id="q10b" value="b">
                        <label for="q10b">They are the same species adapted to different regions, often with different types</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q10" id="q10c" value="c">
                        <label for="q10c">They can only be found in the Kanto region</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q10" id="q10d" value="d">
                        <label for="q10d">They always have the same type as the original</label>
                    </div>
                </div>
            </div>

            <!-- Q11: Gardevoir Analysis (WEAK - 0-100% inconsistent) -->
            <div class="question" data-topic="gardevoir-analysis">
                <div class="question-header">
                    <span class="question-number">11</span>
                    <span class="question-text">Gardevoir (Psychic/Fairy) is strong against which types offensively?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q11" id="q11a" value="a">
                        <label for="q11a">Fighting (both Psychic and Fairy beat Fighting) and Dragon (Fairy beats Dragon)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q11" id="q11b" value="b">
                        <label for="q11b">Steel and Poison (Fairy beats both)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q11" id="q11c" value="c">
                        <label for="q11c">Fire and Water (Psychic beats both)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q11" id="q11d" value="d">
                        <label for="q11d">Normal and Ghost (Fairy beats both)</label>
                    </div>
                </div>
            </div>

            <!-- Q12: Gengar Analysis (WEAK - 0-100% inconsistent) -->
            <div class="question" data-topic="gengar-analysis">
                <div class="question-header">
                    <span class="question-number">12</span>
                    <span class="question-text">Gengar (Ghost/Poison) is often described as a "speedster" in battle. What does this battle role mean?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q12" id="q12a" value="a">
                        <label for="q12a">It focuses on high defense and surviving many hits</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q12" id="q12b" value="b">
                        <label for="q12b">It has high speed and attacks quickly, often KOing opponents before they can react</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q12" id="q12c" value="c">
                        <label for="q12c">It helps the team by setting up status moves</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q12" id="q12d" value="d">
                        <label for="q12d">It has moves that hit multiple opponents at once</label>
                    </div>
                </div>
            </div>

            <!-- Q13: Type Fire-Water-Grass (WEAK - 0-100% inconsistent) -->
            <div class="question" data-topic="type-fire-water-grass">
                <div class="question-header">
                    <span class="question-number">13</span>
                    <span class="question-text">Blastoise (Water) faces Venusaur (Grass/Poison). Which Pokemon has the type advantage?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q13" id="q13a" value="a">
                        <label for="q13a">Blastoise, because Water beats Grass</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q13" id="q13b" value="b">
                        <label for="q13b">Venusaur, because Grass beats Water</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q13" id="q13c" value="c">
                        <label for="q13c">Neither - Water and Grass are neutral to each other</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q13" id="q13d" value="d">
                        <label for="q13d">Blastoise, because Poison resists Water</label>
                    </div>
                </div>
            </div>

            <!-- Q14: Battle Role Tank (WEAK - varied 0-100%) -->
            <div class="question" data-topic="battle-role-tank">
                <div class="question-header">
                    <span class="question-number">14</span>
                    <span class="question-text">Which of these Focus 10 Pokemon best fits the "Tank/Defender" battle role?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q14" id="q14a" value="a">
                        <label for="q14a">Gengar - because it has immunities</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q14" id="q14b" value="b">
                        <label for="q14b">Pikachu - because it's fast</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q14" id="q14c" value="c">
                        <label for="q14c">Snorlax - because it has high HP and can absorb many hits</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q14" id="q14d" value="d">
                        <label for="q14d">Charizard - because it has strong attack power</label>
                    </div>
                </div>
            </div>

            <!-- Q15: Battle Role Attacker (WEAK - varied 0-100%) -->
            <div class="question" data-topic="battle-role-attacker">
                <div class="question-header">
                    <span class="question-number">15</span>
                    <span class="question-text">What is the main goal of an "Attacker/Sweeper" in battle strategy?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q15" id="q15a" value="a">
                        <label for="q15a">To survive as long as possible and stall the opponent</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q15" id="q15b" value="b">
                        <label for="q15b">To deal high damage and knock out opponents quickly</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q15" id="q15c" value="c">
                        <label for="q15c">To set up entry hazards for the team</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q15" id="q15d" value="d">
                        <label for="q15d">To heal team members</label>
                    </div>
                </div>
            </div>

            <!-- Q16: Lucario Analysis (VERY WEAK) - Different question -->
            <div class="question" data-topic="lucario-analysis">
                <div class="question-header">
                    <span class="question-number">16</span>
                    <span class="question-text">What is Lucario's battle role typically described as?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q16" id="q16a" value="a">
                        <label for="q16a">Pure defensive wall</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q16" id="q16b" value="b">
                        <label for="q16b">Balanced attacker (good at both physical and special offense)</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q16" id="q16c" value="c">
                        <label for="q16c">Pure support</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q16" id="q16d" value="d">
                        <label for="q16d">Entry hazard setter</label>
                    </div>
                </div>
            </div>

            <!-- Q17: NOT YET TESTED - Pokedex Basics -->
            <div class="question" data-topic="pokedex-basics">
                <div class="question-header">
                    <span class="question-number">17</span>
                    <span class="question-text">What kind of information would you find in a Pokedex entry?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q17" id="q17a" value="a">
                        <label for="q17a">Only the Pokemon's name</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q17" id="q17b" value="b">
                        <label for="q17b">Type, stats, abilities, and general information about the Pokemon</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q17" id="q17c" value="c">
                        <label for="q17c">Only battle strategies</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q17" id="q17d" value="d">
                        <label for="q17d">Only evolution information</label>
                    </div>
                </div>
            </div>

            <!-- Q18: STRONG AREA REVIEW - Type Electric Flying -->
            <div class="question" data-topic="type-electric-flying">
                <div class="question-header">
                    <span class="question-number">18</span>
                    <span class="question-text">Electric-type moves are super-effective against which two types?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q18" id="q18a" value="a">
                        <label for="q18a">Fire and Grass</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q18" id="q18b" value="b">
                        <label for="q18b">Water and Flying</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q18" id="q18c" value="c">
                        <label for="q18c">Rock and Ground</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q18" id="q18d" value="d">
                        <label for="q18d">Psychic and Ghost</label>
                    </div>
                </div>
            </div>

            <!-- Q19: STRONG AREA REVIEW - Snorlax Analysis -->
            <div class="question" data-topic="snorlax-analysis">
                <div class="question-header">
                    <span class="question-number">19</span>
                    <span class="question-text">Snorlax is a Normal-type wall. Which type is super-effective against Normal types like Snorlax?</span>
                </div>
                <div class="options">
                    <div class="option">
                        <input type="radio" name="q19" id="q19a" value="a">
                        <label for="q19a">Ghost</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q19" id="q19b" value="b">
                        <label for="q19b">Fighting</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q19" id="q19c" value="c">
                        <label for="q19c">Psychic</label>
                    </div>
                    <div class="option">
                        <input type="radio" name="q19" id="q19d" value="d">
                        <label for="q19d">Dark</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section II: Short Answer -->
        <div class="card">
            <div class="section-header">
                <div class="section-icon">II</div>
                <div>
                    <h2 class="section-title">Short Answer</h2>
                    <p class="section-subtitle">Answer in 3-6 sentences (1 question, 2 points)</p>
                </div>
            </div>

            <div class="question" data-topic="dual-type-mechanics">
                <div class="question-header">
                    <span class="question-number">20</span>
                    <span class="question-text">Explain why Charizard (Fire/Flying) takes 4x damage from Rock-type attacks, while Blastoise (Water) only takes normal damage from Rock. Use the concept of dual-type mechanics in your answer.</span>
                </div>
                <div class="answer-hint">
                    <strong>Hint:</strong> Think about how damage is calculated for dual-types. When both types share a weakness, what happens to the damage multiplier? Compare this to a single-type Pokemon where only one type determines the damage.
                </div>
                <textarea id="q20" placeholder="Type your answer here..."></textarea>
            </div>
        </div>

        <!-- Submit Section -->
        <div class="card submit-section">
            <h3>Ready to Submit?</h3>
            <p>Make sure you've answered all questions. You've got this, Student01!</p>
            <button class="btn btn-primary" onclick="saveAnswers()">Submit Quiz</button>
        </div>
    </div>

    <script>
        // Set today's date
        document.getElementById('quiz-date').valueAsDate = new Date();

        // Progress tracking
        function updateProgress() {
            const mcAnswered = Array.from({ length: 19 }, (_, i) => i + 1)
                .filter(n => document.querySelector(`input[name="q${n}"]:checked`)).length;

            const shortAnswer = document.getElementById('q20').value.trim().length > 0 ? 1 : 0;

            const total = mcAnswered + shortAnswer;
            const percentage = (total / 20) * 100;

            document.getElementById('progress').textContent = `${total}/20 answered`;
            document.getElementById('progress-fill').style.width = `${percentage}%`;
        }

        // Add event listeners
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', updateProgress);
        });
        document.querySelectorAll('textarea').forEach(textarea => {
            textarea.addEventListener('input', updateProgress);
        });

        // Grading overlay functions
        function showGradingOverlay() {
            document.getElementById('grading-overlay').classList.add('active');
            document.getElementById('grading-status').textContent = 'Initializing...';
            document.getElementById('grading-error').style.display = 'none';
            document.getElementById('grading-retry-btn').style.display = 'none';
        }

        function hideGradingOverlay() {
            document.getElementById('grading-overlay').classList.remove('active');
        }

        function updateGradingStatus(message) {
            document.getElementById('grading-status').textContent = message;
        }

        function showGradingError(message) {
            document.getElementById('grading-error').textContent = message;
            document.getElementById('grading-error').style.display = 'block';
            document.getElementById('grading-retry-btn').style.display = 'inline-block';
            document.querySelector('#grading-overlay .spinner').style.display = 'none';
        }

        function retryGrading() {
            hideGradingOverlay();
            document.querySelector('#grading-overlay .spinner').style.display = 'block';
            saveAnswers();
        }

        // Poll for grading status
        async function pollGradingStatus(jobId) {
            const maxAttempts = 120;
            let attempts = 0;

            const poll = async () => {
                attempts++;
                try {
                    const response = await fetch(`/api/grading-status/${jobId}`);
                    const data = await response.json();

                    if (data.status === 'complete' && data.resultsUrl) {
                        updateGradingStatus('Grading complete! Redirecting...');
                        setTimeout(() => {
                            window.location.href = data.resultsUrl;
                        }, 1000);
                        return;
                    } else if (data.status === 'error') {
                        showGradingError(data.error || 'Grading failed. Please try again.');
                        return;
                    } else if (data.status === 'processing') {
                        updateGradingStatus(`Professor Oak is analyzing... (${attempts * 2}s)`);
                        if (attempts < maxAttempts) {
                            setTimeout(poll, 2000);
                        } else {
                            showGradingError('Grading is taking longer than expected. Please check back later.');
                        }
                    }
                } catch (error) {
                    console.error('Error polling status:', error);
                    if (attempts < maxAttempts) {
                        setTimeout(poll, 2000);
                    } else {
                        showGradingError('Connection lost. Please refresh the page.');
                    }
                }
            };

            poll();
        }

        // Save answers
        async function saveAnswers() {
            const name = document.getElementById('student-name').value || 'Unknown';
            const date = document.getElementById('quiz-date').value || new Date().toISOString().split('T')[0];

            // Validate name
            if (!document.getElementById('student-name').value.trim()) {
                alert('Please enter your name before submitting!');
                document.getElementById('student-name').focus();
                return;
            }

            // Create timestamp
            const now = new Date();
            const timestamp = now.toISOString().replace(/[:.]/g, '-').replace('T', '_').split('.')[0];

            let content = `ADAPTIVE PRACTICE QUIZ - POKEMON\n`;
            content += `Student: ${name}\n`;
            content += `Date: ${date}\n`;
            content += `Submitted: ${now.toLocaleString()}\n`;
            content += `Focus Areas: Evolution Lines, Dual-Type Mechanics, Lucario, Gyarados, Eevee\n`;
            content += `\n${'='.repeat(60)}\n\n`;

            // Multiple Choice
            content += `PART I: MULTIPLE CHOICE (19 questions)\n`;
            content += `${'-'.repeat(30)}\n`;
            for (let i = 1; i <= 19; i++) {
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                const answer = selected ? selected.value : '(not answered)';
                const questionEl = document.querySelector(`input[name="q${i}"]`).closest('.question');
                const topic = questionEl ? questionEl.dataset.topic : 'unknown';
                content += `Q${i} [${topic}]: ${answer}\n`;
            }

            // Short Answer
            content += `\nPART II: SHORT ANSWER\n`;
            content += `${'-'.repeat(30)}\n`;
            const answer20 = document.getElementById('q20').value || '(not answered)';
            const q20El = document.getElementById('q20').closest('.question');
            const topic20 = q20El ? q20El.dataset.topic : 'unknown';
            content += `\nQ20 [${topic20}]:\n${answer20}\n`;

            // Show grading overlay
            showGradingOverlay();
            updateGradingStatus('Saving your answers...');

            // Try to save to server
            try {
                const response = await fetch('/api/answers/Pokemon', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name,
                        date,
                        timestamp,
                        answers: content,
                        quizName: 'Adaptive_Practice_Quiz'
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    console.log('Saved to server:', result);

                    if (result.jobId) {
                        updateGradingStatus('Answers saved. Professor Oak is grading...');
                        pollGradingStatus(result.jobId);
                    } else {
                        hideGradingOverlay();
                        alert('Success! Your answers have been saved.\n\nFile: ' + result.filename);
                    }
                } else {
                    throw new Error('Server returned error: ' + response.status);
                }
            } catch (error) {
                // Fallback to local download
                console.error('Failed to save to server, downloading locally:', error);
                hideGradingOverlay();
                alert('Could not connect to server. Downloading answers to your device instead.');

                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Adaptive_Practice_Quiz_${name.replace(/\s+/g, '_')}_${timestamp}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        }
    </script>
</body>
</html>
